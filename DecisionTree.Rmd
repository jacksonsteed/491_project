---
title: "Decision Tree - Nhi Phan"
---
  
  
```{r}
#performance, defensive, offensive
#Decision Tree
library(rpart) 
library(rpart.plot)
library(randomForest)
library(tidyverse)
library(tidymodels)
library(tidyr)
library(readxl)
library(dplyr)

#creating training and testing data:
#split into train and test after sorting
final_data <- read_csv("FinalData.csv")
final_data <- final_data %>% arrange(desc(drafted))

drafted_1 <- final_data %>% filter(drafted == 1) %>%  #sdf
  sample_frac(0.8) # Adjust the fraction as needed for training data

# Sample rows where drafted = 0
drafted_0 <- final_data %>% filter(drafted == 0) %>%  #qwe
  sample_frac(0.8) # Adjust the fraction as needed for training data

# Combine sampled data for training dataset
training_data <- bind_rows(drafted_1, drafted_0)  #qwe

# Create testing dataset by removing rows used in training dataset
testing_data <- final_data %>% anti_join(training_data)  #wqe

training_data <- subset(training_data, select = -c(player_name, team))
testing_data <- subset(testing_data, select = -c(player_name, team))

# Create a decision tree model specification
tree_spec <- decision_tree() %>%
  set_engine("rpart") %>%
  set_mode("regression")

# Fit the model to the training data
tree_fit <- tree_spec %>%
  fit(drafted ~ ., data = training_data) #drafted is the target variable

# Make predictions on the testing data
predictions <- tree_fit %>%
  predict(testing_data) %>%
  pull(.pred)

# Calculate RMSE (root mean squared error) and R-squared
metrics <- metric_set(rmse, rsq)
model_performance <- testing_data %>%
 mutate(predictions = predictions) %>%
 metrics(truth = drafted, estimate = predictions)

print(model_performance)

```